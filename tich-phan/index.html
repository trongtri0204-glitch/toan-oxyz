<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H·ªá Th·ªëng Ki·ªÉm Tra T√≠ch Ph√¢n - ThS. Tr·∫ßn Tr·ªçng Tr·ªã</title>
    <script>
      window.MathJax = { tex: { inlineMath: [['$', '$']], displayMath: [['$$', '$$']] }, options: { processHtmlClass: 'mathjax-process' } };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        :root { --bg: #0d1117; --card: #161b22; --accent: #58a6ff; --text: #c9d1d9; --correct: #238636; --wrong: #da3633; --gold: #f1c40f; --ai: #8a2be2; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); display: flex; flex-direction: column; align-items: center; padding: 20px; margin: 0; user-select: none; }
        header { text-align: center; margin-bottom: 20px; border-bottom: 2px solid var(--accent); width: 100%; padding-bottom: 15px; }
        #nameModal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.98); display: flex; justify-content: center; align-items: center; z-index: 9999; }
        .name-box { background: var(--card); padding: 40px; border-radius: 15px; text-align: center; border: 2px solid var(--accent); max-width: 400px; }
        .name-input { padding: 12px; width: 80%; font-size: 1.1rem; border-radius: 6px; border: 1px solid var(--accent); margin-bottom: 20px; background: #0d1117; color: white; outline: none; }
        
        .game-container { max-width: 1050px; width: 100%; display: grid; grid-template-columns: 1fr 380px; gap: 20px; }
        @media (max-width: 850px) { .game-container { grid-template-columns: 1fr; } }
        
        .quiz-card { background: var(--card); padding: 20px; border-radius: 12px; border: 1px solid #30363d; min-height: 500px; display: flex; flex-direction: column; }
        .part-header { color: var(--gold); font-weight: bold; background: #21262d; padding: 8px 12px; border-radius: 6px; margin-bottom: 12px; border-left: 4px solid var(--gold); font-size: 0.9rem; }
        .question-title { color: var(--accent); font-weight: bold; font-size: 1.1rem; margin-bottom: 8px; display: block; }
        .question-text { font-size: 1rem; margin-bottom: 15px; line-height: 1.6; text-align: justify; }
        
        .btn { background: #21262d; border: 1px solid #30363d; color: var(--text); padding: 12px 15px; border-radius: 8px; cursor: pointer; text-align: left; transition: 0.3s; font-size: 0.95rem; display: flex; align-items: flex-start; gap: 8px; margin-bottom: 5px; }
        .btn b { color: var(--accent); }
        .btn.selected { background: #30363d; border-color: var(--accent); border-width: 2px; }
        
        /* B√†n ph√≠m nh·ªè g·ªçn cho 1 m√†n h√¨nh */
        .answer-display { background: #000; color: var(--accent); font-size: 1.8rem; padding: 10px; border-radius: 8px; border: 2px solid var(--accent); min-width: 150px; text-align: center; height: 50px; display: flex; align-items: center; justify-content: center; font-family: monospace; margin-bottom: 15px; }
        .numpad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; width: 100%; max-width: 260px; margin: 0 auto; }
        .num-btn { background: #30363d; border: 1px solid var(--accent); color: #fff; padding: 12px; border-radius: 8px; cursor: pointer; font-size: 1.1rem; font-weight: bold; }

        .img-container { text-align: center; margin: 10px 0; background: white; padding: 8px; border-radius: 8px; }
        .img-container img { max-height: 180px; }

        /* L·ªùi gi·∫£i chi ti·∫øt */
        #final-area { display: none; width: 100%; max-width: 900px; }
        .sol-card { background: var(--card); padding: 25px; border-radius: 12px; margin-top: 30px; border: 1px solid #30363d; }
        .original-review { background: #0d1117; padding: 15px; border-radius: 8px; border: 1px solid #21262d; margin-bottom: 15px; }
        .ai-btn { background: linear-gradient(45deg, #4b0082, #8a2be2); color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer; font-weight: bold; display: flex; align-items: center; gap: 8px; font-size: 0.85rem; }
        .ai-sol-box { display: none; background: #161b22; padding: 20px; border-radius: 10px; border-left: 4px solid var(--ai); margin-top: 15px; line-height: 1.8; font-size: 0.95rem; color: #e6edf3; }
        .step-title { color: var(--gold); font-weight: bold; display: block; margin-top: 10px; }
    </style>
</head>
<body oncontextmenu="return false;">

<div id="nameModal">
    <div class="name-box">
        <h2 style="color:var(--gold)">H·ªÜ TH·ªêNG KI·ªÇM TRA</h2>
        <p>ThS. Tr·∫ßn Tr·ªçng Tr·ªã - GV Chuy√™n To√°n Tr∆∞·ªùng THPT Gia ƒê·ªãnh</p>
        <input type="text" id="studentName" class="name-input" placeholder="Nh·∫≠p t√™n c·ªßa em...">
        <button class="btn" style="text-align:center; width:100%; background:var(--accent); color:white; justify-content: center;" onclick="startGame()">B·∫ÆT ƒê·∫¶U</button>
    </div>
</div>

<header>
    <h1 style="color:var(--gold)">CHINH PH·ª§C T√çCH PH√ÇN 12</h1>
    <p>Gi√°o vi√™n: ThS. Tr·∫ßn Tr·ªçng Tr·ªã - Tr∆∞·ªùng THPT Gia ƒê·ªãnh</p>
</header>

<div class="game-container" id="game-main">
    <div class="quiz-card">
        <div id="part-info" class="part-header"></div>
        <span id="q-title" class="question-title"></span>
        <div id="q-area" class="mathjax-process">
            <div id="q-text" class="question-text"></div>
            <div id="ans-zone" class="options-grid"></div>
        </div>
        <button id="next-btn" class="next-btn" style="margin-top: 15px;" onclick="handleNext()">X√ÅC NH·∫¨N & TI·∫æP THEO ‚ûú</button>
    </div>

    <div class="sidebar">
        <div class="image-box">
            <img src="hinh_game.jpg" style="width:100%; height:100%; object-fit:cover" onerror="this.src='https://via.placeholder.com/350x260?text=Analysis'">
            <div id="grid" class="grid-overlay"></div>
        </div>
        <div class="status">
            <div style="font-size: 1.4rem; color: var(--gold);">ƒêI·ªÇM: <span id="score">0.00</span></div>
            <div id="student-display" style="color:var(--accent); margin: 5px 0;">H·ªçc sinh: ...</div>
            <div style="color: #8b949e;">C√¢u: <span id="total-q">1</span> / 22</div>
        </div>
    </div>
</div>

<div id="final-area">
    <div style='text-align:center; padding:30px; background:var(--card); border-radius:15px; border:2px solid var(--gold); margin-bottom: 30px;'>
        <h2 style='color:var(--gold); margin-top:0;'>HO√ÄN TH√ÄNH</h2>
        <h3 style='color:var(--accent)' id="final-score-display"></h3>
    </div>
    <div id="sol-content" class="mathjax-process"></div>
    <button class="btn" style="margin: 40px 0; width:100%; text-align:center; justify-content: center;" onclick="location.reload()">L√ÄM L·∫†I B√ÄI</button>
</div>

<script>
    const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyu-MpFNTly4cIhVq0cv2YclWmyLtxjQllhss1LzBr2p3vtC02F83Suhh9rUdIoNBzRww/exec";
    let studentName = "", currentIdx = 0, score = 0, userAns = "", v2Ans = [], selectedV1 = null;

    const questions = [
        // PH·∫¶N I
        { part: 1, type: 'v1', num: 1, q: "M·ªánh ƒë·ªÅ n√†o d∆∞·ªõi ƒë√¢y l√† <b>sai</b>?", a: ["$\\displaystyle \\int f'(x) dx = f(x)+C$ v·ªõi m·ªçi h√†m $f(x)$ c√≥ ƒë·∫°o h√†m tr√™n $\\mathbb{R}$","$\\displaystyle \\int [f(x)+g(x)] dx = \\int f(x)dx + \\int g(x)dx$ v·ªõi m·ªçi h√†m $f(x), g(x)$ c√≥ ƒë·∫°o h√†m tr√™n $\\mathbb{R}$","$\\displaystyle \\int k f(x) dx = k \\int f(x)dx$ v·ªõi m·ªçi h·∫±ng s·ªë $k$ v√† v·ªõi m·ªçi h√†m s·ªë $f(x)$ c√≥ ƒë·∫°o h√†m tr√™n $\\mathbb{R}$","$\\displaystyle \\int [f(x)-g(x)] dx = \\int f(x)dx - \\int g(x)dx$ v·ªõi m·ªçi h√†m $f(x), g(x)$ c√≥ ƒë·∫°o h√†m tr√™n $\\mathbb{R}$"], c: "Mg==", 
          sol: "<b>AI Ph√¢n t√≠ch:</b> C√¢u h·ªèi ki·ªÉm tra t√≠nh ch·∫•t tuy·∫øn t√≠nh c·ªßa nguy√™n h√†m.<br><span class='step-title'>‚Ä¢ B∆∞·ªõc 1:</span> X√©t t√≠nh ƒë√∫ng ƒë·∫Øn c·ªßa ƒë·ªãnh nghƒ©a $\\int f'(x)dx = f(x)+C$. ƒê√¢y l√† kh·∫≥ng ƒë·ªãnh A (ƒê√∫ng).<br><span class='step-title'>‚Ä¢ B∆∞·ªõc 2:</span> Ki·ªÉm tra t√≠nh ch·∫•t t·ªïng/hi·ªáu. $\\int(f \\pm g) = \\int f \\pm \\int g$. V·∫≠y B, D (ƒê√∫ng).<br><span class='step-title'>‚Ä¢ B∆∞·ªõc 3:</span> X√©t kh·∫≥ng ƒë·ªãnh C. ƒê·ªÅ b√†i ghi 'v·ªõi m·ªçi h·∫±ng s·ªë $k$'. Tuy nhi√™n, n·∫øu $k=0$, v·∫ø tr√°i l√† $\\int 0 dx = C$, v·∫ø ph·∫£i l√† $0 \\cdot \\int f(x)dx = 0$. V√¨ $C$ c√≥ th·ªÉ kh√°c $0$, n√™n t√≠nh ch·∫•t n√†y ch·ªâ ƒë√∫ng khi $k \\neq 0$.<br><b>K·∫øt lu·∫≠n:</b> Ch·ªçn ph∆∞∆°ng √°n C." },
        
        { part: 1, type: 'v1', num: 2, q: "Nguy√™n h√†m c·ªßa h√†m s·ªë $f(x) = \\cos x$ l√†:", a: ["$-\\sin x + C$", "$\\sin x + C$", "$\\cos x + C$", "$-\\cos x + C$"], c: "MQ==", 
          sol: "<b>AI Ph√¢n t√≠ch:</b> ƒê√¢y l√† c√¢u h·ªèi nh·∫≠n bi·∫øt c√¥ng th·ª©c c∆° b·∫£n.<br><span class='step-title'>‚Ä¢ B∆∞·ªõc 1:</span> Ta c·∫ßn t√¨m h√†m $F(x)$ sao cho $F'(x) = \\cos x$.<br><span class='step-title'>‚Ä¢ B∆∞·ªõc 2:</span> Theo b·∫£ng ƒë·∫°o h√†m c√°c h√†m l∆∞·ª£ng gi√°c s∆° c·∫•p, ta c√≥ $(\\sin x)' = \\cos x$.<br><span class='step-title'>‚Ä¢ B∆∞·ªõc 3:</span> V·∫≠y $\\displaystyle \\int \\cos x dx = \\sin x + C$.<br><b>K·∫øt lu·∫≠n:</b> Ch·ªçn ph∆∞∆°ng √°n B." },
        
        { part: 1, type: 'v1', num: 11, q: "Kh·∫≥ng ƒë·ªãnh n√†o ƒë√∫ng v·ªÅ di·ªán t√≠ch $S$ gi·ªõi h·∫°n b·ªüi $f_1(x), f_2(x)$ (v·ªõi $f_1(x) > f_2(x)$)?<div class='img-container'><img src='cau11.png'></div>", a: ["$S = \\displaystyle \\int_a^b [f_2(x)-f_1(x)] dx$", "$\\displaystyle S = \\int_a^b [f_1(x)-f_2(x)] dx$", "$S = \\displaystyle \\pi \\int_a^b [f_1(x)-f_2(x)]^2 dx$", "$S = \\displaystyle \\pi \\int_a^b [f_1(x)-f_2(x)] dx$"], c: "MQ==", 
          sol: "<b>AI Ph√¢n t√≠ch:</b> ·ª®ng d·ª•ng t√≠ch ph√¢n t√≠nh di·ªán t√≠ch h√¨nh ph·∫≥ng gi·ªõi h·∫°n b·ªüi hai ƒë·ªì th·ªã.<br><span class='step-title'>‚Ä¢ B∆∞·ªõc 1:</span> X√°c ƒë·ªãnh c√¥ng th·ª©c t·ªïng qu√°t: $\\displaystyle S = \\int_a^b |f_1(x) - f_2(x)| dx$.<br><span class='step-title'>‚Ä¢ B∆∞·ªõc 2:</span> Quan s√°t h√¨nh v·∫Ω, tr√™n ƒëo·∫°n $[a, b]$, ƒë·ªì th·ªã h√†m s·ªë $f_1(x)$ n·∫±m ph√≠a tr√™n ƒë·ªì th·ªã h√†m s·ªë $f_2(x)$.<br><span class='step-title'>‚Ä¢ B∆∞·ªõc 3:</span> Do $f_1(x) \\ge f_2(x)$, ta ph√° d·∫•u gi√° tr·ªã tuy·ªát ƒë·ªëi: $\\displaystyle S = \\int_a^b [f_1(x) - f_2(x)] dx$.<br><b>K·∫øt lu·∫≠n:</b> Ch·ªçn ph∆∞∆°ng √°n B." },

        // PH·∫¶N II (V√≠ d·ª• 1 c√¢u)
        { 
            part: 2, type: 'v2', num: 4, q: "Cho h√†m s·ªë $y=f(x)$ li√™n t·ª•c tr√™n $(0;+\\infty)$, c√≥ b·∫£ng bi·∫øn thi√™n c·ªßa $f'(x)$ nh∆∞ sau:<div class='img-container'><img src='cau4_ds.png'></div>", 
            items: [ {l: "$\\int_2^5 f'(x)dx = f(5)-f(2)$", r: "dHJ1ZQ=="}, {l: "$\\int_2^3 f'(x)dx = 1$", r: "ZmFsc2U="}, {l: "Di·ªán t√≠ch gi·ªõi h·∫°n b·ªüi $f'(x), Ox, x=2, x=3$ b·∫±ng $1/2$", r: "ZmFsc2U="}, {l: "N·∫øu $\\int_2^5 |f'(x)|dx=5$ th√¨ $f(5)=5$", r: "ZmFsc2U="} ], 
            sol: "<b>AI Ph√¢n t√≠ch t·ª´ng √Ω:</b><br>‚Ä¢ <b>a: ƒê√∫ng.</b> ƒê√¢y l√† c√¥ng th·ª©c Newton-Leibniz: T√≠ch ph√¢n c·ªßa ƒë·∫°o h√†m b·∫±ng hi·ªáu gi√° tr·ªã h√†m s·ªë t·∫°i hai c·∫≠n.<br>‚Ä¢ <b>b: Sai.</b> T∆∞∆°ng t·ª± √Ω a, $\\int_2^3 f'(x)dx = f(3)-f(2) = -1 - f(2)$. V√¨ $f(x)$ gi·∫£m tr√™n $(2,3)$ n√™n $f(2) > f(3)=-1$, suy ra t√≠ch ph√¢n ph·∫£i mang gi√° tr·ªã √¢m.<br>‚Ä¢ <b>c: Sai.</b> Di·ªán t√≠ch $S = \\int_2^3 |f'(x)|dx = f(2)-f(3) = f(2)+1$. Kh√¥ng c√≥ gi·∫£ thi·∫øt n√†o kh·∫≥ng ƒë·ªãnh $f(2)=-0,5$.<br>‚Ä¢ <b>d: Sai.</b> $\\int_2^5 |f'| = [f(2)-f(3)] + [f(5)-f(3)] = f(2)+f(5)+2$. N·∫øu t·ªïng n√†y b·∫±ng 5 th√¨ $f(2)+f(5)=3$, kh√¥ng ƒë·ªß c∆° s·ªü k·∫øt lu·∫≠n $f(5)=5$." 
        },

        // PH·∫¶N III (V√≠ d·ª• c√¢u 6)
        { 
            part: 3, type: 'v3', num: 6, q: "M·ªôt khu√¥n vi√™n d·∫°ng n·ª≠a h√¨nh tr√≤n, tr√™n ƒë√≥ ng∆∞·ªùi thi·∫øt k·∫ø ph·∫ßn ƒë·ªÉ tr·ªìng hoa C·∫©m T√∫ C·∫ßu (ph·∫ßn ƒë∆∞·ª£c g·∫°ch ch√©o tr√™n h√¨nh v·∫Ω). Bi·∫øt r·∫±ng ph·∫ßn g·∫°ch ch√©o l√† h√¨nh ph·∫≥ng gi·ªõi h·∫°n b·ªüi parabol $y=x^2$ v√† n·ª≠a tr√™n c·ªßa ƒë∆∞·ªùng tr√≤n $y=\\sqrt{20-x^2}$. T√≠nh s·ªë ti·ªÅn (ngh√¨n ƒë·ªìng) t·ªëi thi·ªÉu ƒë·ªÉ tr·ªìng xong v∆∞·ªùn hoa C·∫©m T√∫ C·∫ßu bi·∫øt r·∫±ng ƒë·ªÉ tr·ªìng m·ªói $m^2$ hoa c·∫ßn √≠t nh·∫•t l√† 250 ngh√¨n ƒë·ªìng. (L√†m tr√≤n h√†ng ƒë∆°n v·ªã).<div class='img-container'><img src='cau6_kq.png'></div>", 
            c: "NDk4NQ==", 
            sol: "<b>AI Ph√¢n t√≠ch b√†i to√°n th·ª±c t·∫ø:</b><br><div class='img-container'><img src='cau6_kq_lg.png'></div><br><span class='step-title'>‚Ä¢ B∆∞·ªõc 1: T√¨m ho√†nh ƒë·ªô giao ƒëi·ªÉm.</span> Gi·∫£i ph∆∞∆°ng tr√¨nh: $x^2 = \\sqrt{20-x^2} \\Leftrightarrow x^4 + x^2 - 20 = 0 \\Leftrightarrow x^2 = 4 \\Leftrightarrow x = \\pm 2$.<br><span class='step-title'>‚Ä¢ B∆∞·ªõc 2: Thi·∫øt l·∫≠p t√≠ch ph√¢n.</span> Di·ªán t√≠ch $S = \\displaystyle \\int_{-2}^2 (\\sqrt{20-x^2} - x^2) dx = S_{tron} - S_{parabol}$.<br><span class='step-title'>‚Ä¢ B∆∞·ªõc 3: T√≠nh to√°n.</span> T√≠nh ƒë∆∞·ª£c $S \\approx 19,9396 \\, m^2$.<br><span class='step-title'>‚Ä¢ B∆∞·ªõc 4: Chi ph√≠.</span> T·ªïng ti·ªÅn = $19,9396 \\times 250 = 4984,9 \\approx 4985$ ngh√¨n ƒë·ªìng." 
        }
    ];

    // C√°c h√†m logic x·ª≠ l√Ω
    function startGame() {
        const input = document.getElementById('studentName').value;
        if(!input.trim()) return alert("H·ªçc sinh nh·∫≠p t√™n nh√©!");
        studentName = input;
        document.getElementById('nameModal').style.display = 'none';
        document.getElementById('student-display').innerText = "H·ªçc sinh: " + studentName;
        const grid = document.getElementById('grid'); grid.innerHTML = "";
        for(let i=0; i<24; i++) {
            let t = document.createElement('div'); t.className='tile'; t.id='tile-'+i; grid.appendChild(t);
        }
        render();
    }

    function render() {
        const q = questions[currentIdx] || questions[0];
        const pInfo = document.getElementById('part-info');
        if(q.part === 1) pInfo.innerHTML = "PH·∫¶N I. TR·∫ÆC NGHI·ªÜM 4 PH∆Ø∆†NG √ÅN.";
        else if(q.part === 2) pInfo.innerHTML = "PH·∫¶N II. TR·∫ÆC NGHI·ªÜM ƒê√öNG SAI.";
        else pInfo.innerHTML = "PH·∫¶N III. TR·∫ÆC NGHI·ªÜM TR·∫¢ L·ªúI NG·∫ÆN.";

        document.getElementById('q-title').innerText = "C√¢u " + q.num + ".";
        document.getElementById('total-q').innerText = currentIdx + 1;
        document.getElementById('q-text').innerHTML = q.q;
        const zone = document.getElementById('ans-zone'); zone.innerHTML = ''; 
        selectedV1 = null; userAns = ""; v2Ans = new Array(4).fill(null);

        if(q.type === 'v1') {
            q.a.forEach((opt, i) => {
                let b = document.createElement('button'); b.className='btn'; 
                b.innerHTML = `<b>${['A','B','C','D'][i]}.</b> ${opt}`;
                b.onclick = () => { document.querySelectorAll('.btn').forEach(el=>el.classList.remove('selected')); b.classList.add('selected'); selectedV1 = i; };
                zone.appendChild(b);
            });
        } else if(q.type === 'v2') {
            q.items.forEach((item, i) => {
                let d = document.createElement('div'); d.className='tf-row';
                d.innerHTML = `<div class='tf-label'><b>${['a','b','c','d'][i]})</b> ${item.l}</div><div style='display:flex;gap:5px'>
                    <button class='btn-tf' id='t-${i}' onclick='setV2(${i},true)'>ƒê√∫ng</button>
                    <button class='btn-tf' id='f-${i}' onclick='setV2(${i},false)'>Sai</button></div>`;
                zone.appendChild(d);
            });
        } else {
            zone.innerHTML = `<div style='display:flex; flex-direction:column; align-items:center;'>
                <div class='answer-display' id='disp'>- - -</div>
                <div class='numpad'>${[1,2,3,4,5,6,7,8,9,0,'.','-'].map(n=>`<button class='num-btn' onclick='press("${n}")'>${n}</button>`).join('')}
                <button class='num-btn' style='grid-column:span 3; background:var(--wrong)' onclick='press("C")'>X√ìA</button></div></div>`;
        }
        MathJax.typesetPromise();
    }

    function setV2(i, v) { v2Ans[i] = v; document.getElementById(`t-${i}`).className = v ? 'btn-tf active-t' : 'btn-tf'; document.getElementById(`f-${i}`).className = !v ? 'btn-tf active-f' : 'btn-tf'; }
    function press(v) { if(v === 'C') userAns = ""; else if(userAns.length < 8) userAns += v; document.getElementById('disp').innerText = userAns || "- - -"; }
    function openTile() { const t = document.querySelectorAll('.tile:not(.open)'); if(t.length) t[Math.floor(Math.random()*t.length)].classList.add('open'); }

    function handleNext() {
        const q = questions[currentIdx];
        let correct = false;
        if(q.type === 'v1') { if(selectedV1 === null) return alert("Em ch·ªçn ƒë√°p √°n nh√©!"); if(selectedV1.toString() === atob(q.c)) { score += 0.25; correct = true; } }
        else if(q.type === 'v2') { if(v2Ans.includes(null)) return alert("Ch·ªçn h·∫øt ƒëi em!"); let cc = 0; q.items.forEach((it, i) => { if(v2Ans[i].toString() === atob(it.r)) cc++; }); score += [0, 0.1, 0.25, 0.5, 1.0][cc]; if(cc === 4) correct = true; }
        else { if(!userAns) return alert("Nh·∫≠p s·ªë!"); if(userAns == atob(q.c)) { score += 0.5; correct = true; } }
        if(correct) openTile();
        document.getElementById('score').innerText = score.toFixed(2);
        currentIdx++;
        if(currentIdx < questions.length) render(); else finish();
    }

    function finish() {
        document.getElementById('game-main').style.display = 'none';
        document.getElementById('final-area').style.display = 'block';
        document.getElementById('final-score-display').innerText = "ƒêi·ªÉm s·ªë c·ªßa em: " + score.toFixed(2) + " / 10";
        let html = "";
        questions.forEach((q, i) => {
            let pText = q.part === 1 ? "PH·∫¶N I" : (q.part === 2 ? "PH·∫¶N II" : "PH·∫¶N III");
            let optionsH = "";
            if(q.type === 'v1') { q.a.forEach((opt, idx) => { optionsH += `<div style='margin:5px 20px;'><b>${['A','B','C','D'][idx]}.</b> ${opt}</div>`; }); }
            else if(q.type === 'v2') { q.items.forEach((it, idx) => { optionsH += `<div style='margin:5px 20px;'><b>${['a','b','c','d'][idx]})</b> ${it.l}</div>`; }); }

            html += `<div class='sol-card'>
                <div class='original-review'>
                    <b style='color:var(--gold)'>${pText} - C√¢u ${q.num}:</b><br>${q.q}
                    <div class='options-review'>${optionsH}</div>
                </div>
                <button class='ai-btn' onclick='toggleAI(${i})'><span>ü§ñ</span> AI PH√ÇN T√çCH & GI·∫¢I CHI TI·∫æT</button>
                <div class='ai-sol-box' id='ai-box-${i}'>${q.sol}</div>
            </div>`;
        });
        document.getElementById('sol-content').innerHTML = html;
        document.querySelectorAll('.tile').forEach(t => t.classList.add('open'));
        MathJax.typesetPromise();
    }
    function toggleAI(idx) { let box = document.getElementById('ai-box-'+idx); box.style.display = (box.style.display === 'block') ? 'none' : 'block'; }
</script>
</body>
</html>
